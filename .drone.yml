kind: pipeline
name: default

steps:
- name: docker-pull
  image: docker:dind
  privileged: true
  volumes:
  - name: dockersock
    path: /var/run/docker.sock
  commands:
  - docker pull wipac/monitoring-scripts:latest

- name: docker
  image: plugins/docker
  settings:
    repo: wipac/monitoring-scripts
    auto_tag: true
    username:
      from_secret: DOCKERHUB_USER
    password:
      from_secret: DOCKERHUB_PASS

volumes:
- name: dockersock
  host:
    path: /var/run/docker.sock